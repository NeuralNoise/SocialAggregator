var isMobile="ontouchstart" in document.documentElement;var lastAddedDate;var oldestAddedDate;var pauseUpdates=false;var updateRequestInProgress=false;var updateCount=0;var defaultItemsCount=30;var periodToForceUpdateInMilliseconds=20000;var timeToRefreshPageInMilliseconds=1800000;var refeshPageCount=timeToRefreshPageInMilliseconds/periodToForceUpdateInMilliseconds;var timer;var timer_is_on=0;var cleanupTimer;var itemsOnScreen=0;var facebookLoginResponded=false;var fbUserId;var fbConnected=false;var fbTimer;var periodToCheckFacebookInMilliseconds=180000;var fbDatesArray=new Array();var twitterConnected=false;var twitterTimer;var periodToCheckTwitterInMilliseconds=120000;var twitterDatesArray=new Array();var trendTimer;var periodToGetTrendsInMilliseconds=300000;var favouriteFeedsArray=new Array();var defaultSearchText="Search your Rolio feed";var emptyGroupText="Drag a logo from your feed or from Recently Added.";var editingGroupId=null;var mouseInsideEditGroup=false;var favSelected=false;var favSelectedName;var favSelectedId;var groupSelected=false;var groupSelectedName;var groupSelectedId;var feedToAddToNewGroup=-1;var imageBlobPath="https://rws.blob.core.windows.net/images/";var logoBlobPath="https://rws.blob.core.windows.net/logo/";var mainLogoBlobPath="https://rws.blob.core.windows.net/mainlogo/";$.ajaxSetup({type:"POST",headers:{"cache-control":"no-cache"}});document.onkeyup=function(a){var a=window.event||a;if(a.keyCode==27){ClearSearch()}};$(document).ready(function(){if(!isMobile){$(".searchTip").tipTip({edgeOffset:5})}});$(document).ready(function(){$(".clickEdit").editable("FeedSearchServiceExporter.asmx/SaveUserGroupName",{indicator:"<img src='"+imageBlobPath+"mainloader_0093D9.gif'>",tooltip:"Click to create new group...",style:"inherit",width:"130px",submitdata:{feedNewGroup:-1},onreset:editableOnReset,onsubmit:function(b,a){if(isGroupNameValid(a)){return true}else{return false}},data:function(b,a){return""},callback:function(b,a){GetUserGroups()}})});function isGroupNameValid(a){var c=$("input",a).val();var b=$(".group-error-message",a.parentElement);var d=/^[\w ]+$/i;var e=d.test(c);if(!e){b.html("Sorry, no symbols!");b.css("display","inline-block");return false}if(c.length>25){b.html("Max 25 characters!");b.css("display","inline-block");return false}b.css("display","none");return true}function editableOnReset(b,a){$(".group-error-message",a.parentElement).css("display","none")}$(window).scroll(function(){if($(window).scrollTop()==$(document).height()-$(window).height()){ShowMoreFeedsClicked()}});function StreamOnLoad(){lastAddedDate=null;oldestAddedDate=null;CheckFacebookLogin();CheckTwitterLogin();CheckNotification();CheckFeedCount();GetRecentlyAdded();GetFavouriteFeeds(false);GetUserGroups();GetTrends();StartUpdateLoop()}function StartUpdateLoop(){if(!timer_is_on){timer_is_on=1;setTimeout("GetFeedUpdatesLoop()",periodToForceUpdateInMilliseconds);setTimeout("GetFbUpdatesLoop()",periodToCheckFacebookInMilliseconds);setTimeout("GetTweetsLoop()",periodToCheckTwitterInMilliseconds);setTimeout("GetTrendsLoop()",periodToGetTrendsInMilliseconds)}}function GetFeedUpdatesLoop(){if(!pauseUpdates&&!updateRequestInProgress){if(updateCount==refeshPageCount){ShowCleanUpOverlay()}GetFeedUpdates();updateCount=updateCount+1}timer=setTimeout("GetFeedUpdatesLoop()",periodToForceUpdateInMilliseconds)}function GetFbUpdatesLoop(){if(!pauseUpdates){GetFacebookStatuses(false)}fbTimer=setTimeout("GetFbUpdatesLoop()",periodToCheckFacebookInMilliseconds)}function GetTweetsLoop(){if(!pauseUpdates){GetTweets()}twitterTimer=setTimeout("GetTweetsLoop()",periodToCheckTwitterInMilliseconds)}function GetTrendsLoop(){GetTrends();trendsTimer=setTimeout("GetTrendsLoop()",periodToGetTrendsInMilliseconds)}function CleanUpPage(){CloseCleanUpOverlay();ShowLoader();window.scroll(0,0);var a=false;$(".msg",$("#mainentries")).each(function(b){if(b==29){if(this.attributes.fullDate){oldestAddedDate=this.attributes.fullDate.value;a=true}}if(b>29){if(!a){if(this.attributes.fullDate){oldestAddedDate=this.attributes.fullDate.value;a=true}}$(this).fadeOut("slow")}});updateCount=0;HideLoader()}function CancelCleanUpPage(){CloseCleanUpOverlay();window.clearInterval(cleanupTimer);updateCount=75}function CheckFacebookLogin(){try{ShowLoader();FB.getLoginStatus(handleFacebookResponse);setTimeout("CheckFacebookLoginResponded()",3000)}catch(a){setTimeout("CheckFacebookLogin()",2000)}}function CheckFacebookLoginResponded(){if(!facebookLoginResponded){FB.getLoginStatus(handleFacebookResponse)}setTimeout("ShowFbLoginLinkIfNoResponse()",2000)}function ShowFbLoginLinkIfNoResponse(){if(!facebookLoginResponded){facebookLoggedOut()}HideLoader()}function handleFacebookResponse(a){facebookLoginResponded=true;if(!a.authResponse){facebookLoggedOut()}else{facebookLoggedIn();FB.api("/me/statuses?limit=1","get",function(d){if(!d||d.error){$get("fbIcon").src=imageBlobPath+"facebook-default-profile.png";$get("fbIcon").style.display=""}else{if(d.data&&d.data[0]){fbUserId=d.data[0].from.id;var c=d.data[0].message;if(c.length>140){c=c.substring(0,140);var b=c.lastIndexOf(" ");if(b>0){c=c.substring(0,b)}c+="..."}$get("fbIcon").src="https://graph.facebook.com/"+fbUserId+"/picture";$get("fbIcon").style.display="";jQuery("#lblFacebookStatus").html(c).fadeIn(1000)}}});HideLoader()}}function facebookLoggedIn(){fbConnected=true;$get("facebook_loggedout").style.display="none";$get("facebook_loggedin").style.display="";$get("txtFacebookStatus").style.display="";$get("btnUpdateStatus").style.display=""}function facebookLoggedOut(){fbConnected=false;$get("facebook_loggedin").style.display="none";$get("facebook_loggedout").style.display="";$get("fbIcon").style.display="none";jQuery("#lblFacebookStatus").html("");$get("txtFacebookStatus").style.display="none";$get("btnUpdateStatus").style.display="none"}var facebookClearedStatus=false;function facebookDummyStatusClear(a){if(!facebookClearedStatus){a.className="";a.value="";facebookClearedStatus=true;$get("btnUpdateStatus").disabled=""}}function facebookStatusBlur(a){if(a.value==""){facebookDummyStatusSet()}}function facebookDummyStatusSet(){var a=$get("txtFacebookStatus");a.className="dummyText";a.value="Enter new status...";facebookClearedStatus=false;$get("btnUpdateStatus").disabled="disabled"}function updateFacebookStatus(){$get("btnUpdateStatus").disabled=true;ShowLoader();var a=$get("txtFacebookStatus").value;if($.trim(a).length==0){facebookDummyStatusSet();HideLoader();return}FB.api("/me/feed","post",{message:a},function(b){if(!b||b.error){jQuery("#facebookErrorDiv").html("Sorry, please try again...")}else{jQuery("#facebookErrorDiv").html("");a=TruncateText(a);$("#lblFacebookStatus").fadeOut("slow",function(){$("#lblFacebookStatus").html(a).fadeIn(1000)});facebookDummyStatusSet()}});$get("btnUpdateStatus").disabled=false;HideLoader()}function FacebookLikePost(a){if(fbConnected){var b="/"+a+"/likes";FB.api(b,"post",function(c){if(!c||c.error){}else{$("#Like"+a).addClass("hidden");$("#Like"+a).removeClass("likeFBMouseOver");$("#Liked"+a).removeClass("hidden");$("#"+a).effect("highlight",{},3000)}})}}function GetFacebookStatuses(a){if(fbConnected){FB.api("/me/home?return_ssl_resources=1","get",function(b){if(!b||b.error){}else{if(b.data){if(a){$("#userSearchResultsPlaceHolder").html("")}var c=b.data;$.each(c,function(e){var g=null;var f=null;var j=false;f=ParseFacebookDate(this.created_time);this.created_time=f.getFullYear()+"-"+(f.getMonth()+1)+"-"+f.getDate()+"T"+f.getHours()+":"+f.getMinutes()+":"+f.getSeconds();if(this.likes&&this.likes.data){var d=this.likes.data;$.each(d,function(k){if(this.id==fbUserId){j=true;return false}})}this.likesPost=j;if(this.type=="status"&&this.message&&!this.to){g=GetFacebookStatusHtml(this)}else{if(this.type=="photo"){g=GetFacebookPhotoHtml(this)}}if(g){var i=($get("welcomeDiv")&&$get("welcomeDiv").style.display=="");if(i){$get("welcomeDiv").style.display="none"}if(a){$(g).appendTo("#userSearchResultsPlaceHolder");return true}var h=this.id;$(".msg",$("#mainentries")).each(function(){var k=formatTDateTime(this.attributes.time.value);if(f<k){return true}else{if(jQuery.inArray(f.toString(),fbDatesArray)==-1){$(g).insertBefore(this);$("#"+h).effect("highlight",{padding:"3px 0 3px 0"},3000);fbDatesArray.push(f.toString())}return false}})}});if(a){HideLoader();$("#clearSearch").removeClass("hidden");$("#resultCount").removeClass("hidden");if(c.length>0){$("#userSearchResultContainer").removeClass("hidden");$("#resultCount").html("Showing latest facebook updates");$("#userSearchResultsPlaceHolder").fadeIn("slow");$("#userSearchResultContainer").effect("slide",{},500)}else{$("#resultCount").html("Sorry, you have no facebook updates")}}}ProcessTooltipAndTimestamp();if(!isMobile){$(".likeFBMouseOver").tipTip({edgeOffset:5,delay:0,defaultPosition:"right"});$(".likedFBPost").tipTip({edgeOffset:5,delay:0,defaultPosition:"right"})}}})}}function GetFacebookStatusHtml(b){var a=GetFacebookTemplateHeaderHtml(b);a+=b.message;a+=GetFacebookTemplateFooterHtml(b);return a}function GetFacebookPhotoHtml(b){var a=GetFacebookTemplateHeaderHtml(b);a+="<br/><a href='"+b.link+"' target='_blank'><img src='"+b.picture+"'></a><br /><br />";if(b.story){a+=b.story+"<br/>"}else{if(b.message){a+=b.message+"<br/>"}}if(b.name){a+=b.name+" "}if(b.caption){a+="("+b.caption+")"}a+=GetFacebookTemplateFooterHtml(b);return a}function GetFacebookTemplateHeaderHtml(b){var a="<div id='"+b.id+"' class='msg' time='"+b.created_time+"'><div class='msg-src'><img src='"+imageBlobPath+"facebook-icon.png' width='20' height='20' alt='Facebook'>";if(b.likesPost){a+="<img id='Liked"+b.id+"' class='likedFBPost' src='"+imageBlobPath+"facebook-liked.png' title='You like this'></div>"}else{a+="<div id='Like"+b.id+"'";if(!isMobile){a+=" class='likeFBMouseOver'"}a+=" title='Like'><a href='javascript:void(0)' onclick=\"FacebookLikePost('"+b.id+"', this);\"><img src='"+imageBlobPath+"facebook-like.png'></a></div><img id='Liked"+b.id+"' src='"+imageBlobPath+"facebook-liked.png' class='likedFBPost hidden' title='You like this'></div>"}a+="<div class='msg-img' title='"+b.from.name+"'><a href='https://www.facebook.com/"+b.from.id+"' target='_blank'><img src='https://graph.facebook.com/"+b.from.id+"/picture'' width='50px' height='50px' class='msg-img-img'></a></div>";a+="<div class='msg-txt'><div class='title'><a href='https://www.facebook.com/"+b.from.id+"' target='_blank'>"+b.from.name+"</a></div>";a+="<div class='clear'></div>";return a}function GetFacebookTemplateFooterHtml(a){return"<div class='sub-msg'><br /><a href='javascript:void(0);' onclick=\"SearchFavourite('Facebook', 'Facebook');\"><img src='"+imageBlobPath+"facebook.png' width='64' height='20' class='sub-msg-img' title='Click to view more from Facebook'></a><div class='prettyDate' time='"+a.created_time+"'></div></div></div></div>"}function TwitterLogin(){$get("btnTwitterConnect").click()}function TwitterLogout(){$get("btnTwitterLogout").click()}function LimitTextLength(a){if(a.value.length>140){a.value=a.value.substring(0,140)}}function TruncateText(b){if(b.length>140){b=b.substring(0,140);var a=b.lastIndexOf(" ");if(a>0){b=b.substring(0,a)}b+="..."}return b}function CheckTwitterLogin(){var a=true;if(a&&$get("hiddenTwitterAuthorised").value=="true"){TwitterLoggedIn()}else{TwitterLoggedOut()}}function TwitterLoggedIn(){twitterConnected=true;$get("twitter_loggedout").style.display="none";$get("twitter_loggedin").style.display="";$get("imgTwitterConnection").src=""+imageBlobPath+"online_green.png";$get("twitterLoginLink").style.display="none";$get("twitterLogoutLink").style.display="";$get("tweetTable").style.display="";TwitterGetLastTweet(false)}function TwitterGetLastTweet(a){if(twitterConnected){$.ajax({type:"POST",url:"FeedSearchServiceExporter.asmx/GetLastTweet",data:{},success:OnGetLastTweetsSuccess,error:function(d,b,c){TwitterLoggedOut()}})}}function OnGetLastTweetsSuccess(d,a){var b=d.documentElement.childNodes[0].wholeText?d.documentElement.childNodes[0].wholeText:d.documentElement.childNodes[0].data;var d=$.parseJSON(b);if(d.length==1){var c=d[0].text;var e=d[0].user.profile_image_url_https;if(c.length>0){$get("lblTwitterStatus").innerHTML=c}document.getElementById("twitterIcon").src=e}else{document.getElementById("twitterIcon").src=imageBlobPath+"twitter-default-profile.png"}HideLoader()}function TwitterLoggedOut(){twitterConnected=false;$get("twitter_loggedin").style.display="none";$get("twitter_loggedout").style.display="";document.getElementById("twitterLogoutLink").style.display="none";document.getElementById("twitterLoginLink").style.display="";document.getElementById("imgTwitterConnection").src=imageBlobPath+"offline_red.png";document.getElementById("tweetTable").style.display="none"}var twitterClearedStatus=false;function twitterDummyStatusClear(a){if(!twitterClearedStatus){a.className="";a.value="";twitterClearedStatus=true;$get("btnTwitterTweet").disabled=""}}function twitterStatusBlur(a){if(a.value==""){twitterDummyStatusSet()}}function twitterDummyStatusSet(){var a=$get("txtTwitterTweet");a.className="dummyText";a.value="Enter new tweet...";twitterClearedStatus=false;$get("btnTwitterTweet").disabled="disabled"}function GetTweets(){if(twitterConnected){$.ajax({type:"POST",url:"FeedSearchServiceExporter.asmx/GetTweets",data:{},success:OnGetTweetsSuccess,error:function(c,a,b){TwitterLoggedOut()}})}}function OnGetTweetsSuccess(c,a){var b=c.documentElement.childNodes[0].wholeText?c.documentElement.childNodes[0].wholeText:c.documentElement.childNodes[0].data;var c=$.parseJSON(b);var d=($get("welcomeDiv")&&$get("welcomeDiv").style.display=="");if(d&&c.length>0){$get("welcomeDiv").style.display="none"}$.each(c,function(e){var f=ParseTwitterDate(this.created_at);this.created_at=f.getUTCFullYear()+"-"+(f.getUTCMonth()+1)+"-"+f.getUTCDate()+"T"+f.getUTCHours()+":"+f.getUTCMinutes()+":"+f.getUTCSeconds();f=new Date((this.created_at).replace(/-/g,"/").replace(/[TZ]/g," "));if(jQuery.inArray(f.toString(),twitterDatesArray)!=-1){return true}var h=this;var g=GetTweetHtml(this);if(d){$(g).appendTo("#mainentries");$("#"+h.id).effect("highlight",{padding:"3px 0 3px 0"},3000);twitterDatesArray.push(f.toString())}else{$(".msg",$("#mainentries")).each(function(){var i=new Date((this.attributes.time.value||"").replace(/-/g,"/").replace(/[TZ]/g," "));if(f<i){return true}else{$(g).insertBefore(this);$("#"+h.id).effect("highlight",{padding:"3px 0 3px 0"},3000);twitterDatesArray.push(f.toString());return false}})}});ProcessTooltipAndTimestamp();if(!isMobile){$(".retweetMouseOver").tipTip({edgeOffset:5,delay:0,defaultPosition:"right"});$(".retweetedPost").tipTip({edgeOffset:5,delay:0,defaultPosition:"right"})}twttr.anywhere(function(e){e("#mainentries").hovercards()})}function ShowTweetsOnly(){if(twitterConnected){$("#userSearchResultContainer").addClass("hidden");$("#userSearchResultsPlaceHolder").html("");$("#clearSearch").addClass("hidden");$("#resultCount").html("&nbsp;");ClearFavourite();ShowLoader();$.ajax({type:"POST",url:"FeedSearchServiceExporter.asmx/GetTweets",data:{},success:OnShowTweetsOnlySuccess,error:function(c,a,b){TwitterLoggedOut()}})}}function OnShowTweetsOnlySuccess(c,a){$("#userSearchResultsPlaceHolder").html("");window.scroll(0,0);var b=c.documentElement.childNodes[0].wholeText?c.documentElement.childNodes[0].wholeText:c.documentElement.childNodes[0].data;var c=$.parseJSON(b);$.each(c,function(d){var e=ParseTwitterDate(this.created_at);this.created_at=e.getUTCFullYear()+"-"+(e.getUTCMonth()+1)+"-"+e.getUTCDate()+"T"+e.getUTCHours()+":"+e.getUTCMinutes()+":"+e.getUTCSeconds();var f=GetTweetHtml(this);$(f).appendTo("#userSearchResultsPlaceHolder")});ProcessTooltipAndTimestamp();HideLoader();$("#clearSearch").removeClass("hidden");$("#resultCount").removeClass("hidden");if(c.length>0){$("#userSearchResultContainer").removeClass("hidden");$("#resultCount").html("Showing latest 20 tweets");$("#userSearchResultsPlaceHolder").fadeIn("slow");$("#userSearchResultContainer").effect("slide",{},500)}else{$("#resultCount").html("Sorry, you have no tweets")}twttr.anywhere(function(d){d("#userSearchResultsPlaceHolder").hovercards()})}function ParseTwitterDate(a){var b=a.length;return new Date(a.substring(0,10)+" "+a.substring(b-4)+" "+a.substring(10,25))}function ParseFacebookDate(b){var a=b.substring(0,19);return new Date((a).replace(/-/g,"/").replace(/[TZ]/g," "))}function formatTDateTime(e){var d=e.split("T");var b=d[0].split("-");var a=d[1].substring(0,8);var c=a.split(":");return new Date(b[0],b[1]-1,b[2],c[0],c[1],c[2])}function GetTweetHtml(d){var c=(d.id_str)?d.id_str:d.id;var a=d.text.replace(/(http:\/\/\S+)/g,"<a href='$1' target='_blank'>$1</a>");a=a.replace(/(https:\/\/\S+)/g,"<a href='$1' target='_blank'>$1</a>");var b="<div id='"+d.id+"' class='msg' time='"+d.created_at+"'><div class='msg-src'><img src='"+imageBlobPath+"twitter-icon.png' width='20' height='20'>";if(d.retweeted){b+="<img id='Retweeted"+c+"' src='"+imageBlobPath+"twitter-retweeted.png' class='retweetedPost' title='You have retweeted this'></div>"}else{b+="<div id='Retweet"+c+"'";if(!isMobile){b+=" class='retweetMouseOver'"}b+=" title='Retweet'><a href='javascript:void(0)' onclick=\"TwitterRetweet('"+c+"', '"+d.id+"');\"><img src='"+imageBlobPath+"twitter-retweet.png'></a></div><img id='Retweeted"+c+"' src='"+imageBlobPath+"twitter-retweeted.png' class='retweetedPost hidden' title='You have retweeted this'></div>"}b+="<div class='msg-img' title='"+d.user.screen_name+"'><a href='https://twitter.com/"+d.user.screen_name+"' target='_blank'><img src='"+d.user.profile_image_url_https+"' width='50px' height='50px' class='msg-img-img'></a></div>";b+="<div class='msg-txt'><div class='title'><a href='https://twitter.com/"+d.user.screen_name+"' target='_blank'>"+d.user.screen_name+"</a></div>";b+="<div class='clear'></div>"+a+"<div class='sub-msg'><br /><a href='javascript:void(0);' onclick=\"SearchFavourite('Twitter', 'Twitter');\"><img src='"+imageBlobPath+"twitter.png' width='61' height='20' class='sub-msg-img' title='Click to view more from Twitter'><a/><div class='prettyDate' time='"+d.created_at+"'></div></div></div></div>";return b}function TwitterTweet(){ShowLoader();$get("btnTwitterTweet").disabled=true;var a=$get("txtTwitterTweet").value;if($.trim(a).length==0){twitterDummyStatusSet();HideLoader();return}$.ajax({type:"POST",url:"FeedSearchServiceExporter.asmx/PostTweet",data:{tweetText:a},success:TweetSuccess,error:function(d,b,c){$("#twitterErrorDiv").html("Sorry, please try again...");twitterDummyStatusSet();HideLoader()}});$get("btnTwitterTweet").disabled=false}function TweetSuccess(b,a){$("#twitterErrorDiv").html("");setTimeout("TwitterGetLastTweet(true)",4000);twitterDummyStatusSet()}function TwitterRetweet(a,b){if(twitterConnected){$.ajax({type:"POST",url:"FeedSearchServiceExporter.asmx/Retweet",data:{tweetId:a},success:function(d,c){$("#Retweet"+a).addClass("hidden");$("#Retweet"+a).removeClass("retweetMouseOver");$("#Retweeted"+a).removeClass("hidden");$("#"+b).effect("highlight",{},3000)},error:function(e,c,d){}})}}function CheckNotification(){if(_showNotification=="True"){$("#userNotificationDiv").css("display","")}if(document.getElementById("hiddenNotification").value.length>0){$("#userNotificationLabel2").html($get("hiddenNotification").value);$("#userNotificationDiv").css("display","");$get("hiddenNotification").value=""}}function HideNotification(){$("#userNotificationDiv").slideUp(500)}function CheckFeedCount(){if(_userFeedsArray.length==0){LoadWizard()}else{if(_isNewUser=="True"){ShowHelp()}}}function LoadStream(){$("#userSearchResultContainer").addClass("hidden");ShowLoader();$.ajax({type:"POST",url:"FeedSearchServiceExporter.asmx/LoadStream",data:{},success:OnLoadStreamSuccess,error:function(c,a,b){}})}function OnLoadStreamSuccess(d,a){var b=d.documentElement.childNodes[0].wholeText?d.documentElement.childNodes[0].wholeText:d.documentElement.childNodes[0].data;var d=$.parseJSON(b);$("#mainentries").html("");$("#mainentries").css("display","none");if(d.length==0){var c=GetWelcomeDivHtml();$(c).appendTo("#mainentries");$("#mainentries").fadeIn("slow")}else{$.each(d,function(e){if(e==0){lastAddedDate=this.AddedDate}else{if(e==d.length-1){oldestAddedDate=this.AddedDate}}var f=GetFeedItemHtml(this,false);$(f).appendTo("#mainentries");$(".draggableFeed").draggable({cursor:"move",revert:true,helper:"clone",start:handleFavDragStart})});ProcessTooltipAndTimestamp();$("#mainentries").fadeIn("slow");BindContextMenus();if(d.length==defaultItemsCount){$get("showMoreDiv").style.display="block"}itemsOnScreen=itemsOnScreen+d.length}HideLoader();twitterDatesArray=new Array();GetTweets();setTimeout("GetFacebookStatuses(false)",5000)}function ProcessTooltipAndTimestamp(){if(!isMobile){$(".msg-img").tipTip({edgeOffset:5,delay:0});$(".sub-msg-img").tipTip({edgeOffset:5,delay:0})}$(".prettyDate").prettyDate()}function ProcessTrendTooltipAndTimestamp(){if(!isMobile){$(".fav-img").tipTip({edgeOffset:5,delay:0});$(".addFeed").tipTip({edgeOffset:5,delay:0,defaultPosition:"right"});$(".sub-msg-img").tipTip({edgeOffset:5,delay:0})}$(".prettyDate").prettyDate()}function ShowLoader(){$get("mainloaderimg").style.display="block"}function HideLoader(){$get("mainloaderimg").style.display="none"}function ShowBottomLoader(){$get("bottomLoader").style.display="block"}function HideBottomLoader(){$get("bottomLoader").style.display="none"}function GetWelcomeDivHtml(){var a="<div class='msg' id='welcomeDiv' time='2000-01-01T01:01:01'><div class='msg-src'><br /><br /><br /><img id='welcomeArrowImg1' style='display:none; position:relative;' src='"+imageBlobPath+"arrow_top_right.png' /><br /><img id='welcomeArrowImg2' style='display:none; position:relative;' src='"+imageBlobPath+"arrow_top_right.png' /></div><div class='msg-img'><img src='"+mainLogoBlobPath+"rolio.png' width='50' height='50'></div><div class='msg-txt'><div class='title'><a href='javascript:void(0);'>Welcome to Rolio!</a></div><div class='clear'></div><br />Getting started with Rolio is really simple.<br /><br /> Click the <b>'Add Feeds'</b> link to tell us the websites you are interested in.<br /><br />Click the <b>'Social'</b> link to integrate your Facebook and Twitter accounts.<div class='sub-msg'><br /><img src='"+imageBlobPath+"logo-main.png' width='60' height='40' ></div></div></div>";return a}function GetFavouriteFeeds(a){if(a){ClearSearch()}$get("showMoreDiv").style.display="none";$.ajax({type:"POST",url:"FeedSearchServiceExporter.asmx/GetFavouriteFeeds",data:{},success:OnGetFavouriteFeedsSuccess(a),error:function(d,b,c){LoadStream()}})}var OnGetFavouriteFeedsSuccess=function(a){return function(c,d){var b=c.documentElement.childNodes[0].wholeText?c.documentElement.childNodes[0].wholeText:c.documentElement.childNodes[0].data;var c=$.parseJSON(b);$("#fav-items").html("");favouriteFeedsArray=new Array();if(!isMobile){$("#favouritesGroupOptions").addClass("hidden")}if(c.length==0){$("#favLabel").removeClass("hidden");$("#favLabel").html(emptyGroupText)}else{$("#favLabel").addClass("hidden")}$.each(c,function(e){favouriteFeedsArray.push(parseInt(this.FeedId));var f=GetFavouriteHtml(this,0,"");$(f).appendTo("#fav-items")});$("#favouritesGroup").droppable({hoverClass:"hovered",drop:handleFavDropEvent});$("#createNewGroupHeader").droppable({hoverClass:"hovered",drop:handleFavDropEvent});if(a){$("#right").fadeIn("slow",function(){$("#fav-items").effect("highlight",{padding:"3px 0 3px 0"},3000)})}else{$("#right").fadeIn("slow")}if(!isMobile){$(".fav-img").tipTip({edgeOffset:5,delay:0});$(".tipTitle").tipTip({edgeOffset:5,delay:0,defaultPosition:"right"});$(".deleteFav").tipTip({edgeOffset:5,delay:0,defaultPosition:"right"})}LoadStream()}};var minimizeOverride=false;var maximizeOverride=false;function handleFavDragStart(a,b){}function GetUserGroups(){$.ajax({type:"POST",url:"FeedSearchServiceExporter.asmx/GetUserGroups",data:{},success:OnGetUserGroupsSuccess,error:function(c,a,b){}})}function OnGetUserGroupsSuccess(c,d){var b=c.documentElement.childNodes[0].wholeText?c.documentElement.childNodes[0].wholeText:c.documentElement.childNodes[0].data;var c=$.parseJSON(b);$("#UserGroups").html("");$("#userGroupSelect").html("");$("#userGroupSelect2").html("");if(c.length>0){$.each(c,function(e){var h=this.GroupID+"UserGroup";var g=h+"-items";var f=GetGroupHtml(h,g,this);var i=GetUserGroupDropdownHtml(this.Name,this.GroupID);$(f).appendTo("#UserGroups");$("#"+h).droppable({hoverClass:"hovered",drop:handleFavDropEvent});$(i).appendTo("#userGroupSelect");$(i).appendTo("#userGroupSelect2");$("#"+h).hover(function(){mouseInsideEditGroup=g},function(){mouseInsideEditGroup=null})});if(!isMobile){$(".fav-img").tipTip({edgeOffset:5,delay:0});$(".tipTitle").tipTip({edgeOffset:5,delay:0,defaultPosition:"right"});$(".deleteFav").tipTip({edgeOffset:5,delay:0,defaultPosition:"right"})}}var a=GetUserGroupDropdownHtml("* New Group",-1);$(a).appendTo("#userGroupSelect");$(a).appendTo("#userGroupSelect2")}function handleFavDropEvent(d,e){var a=e.draggable;a.draggable("option","revert",false);var b=a.attr("feedId");var c=this.attributes.groupId.value;if(c==0){SetFavouriteFeed(b);return}InsertFeedToGroupById(b,c)}function GetGroupHtml(g,c,i){var a=i.Name.replace(/'/g,"&#39;").replace(/"/g,"&#39;");var b=i.GroupID;var d=b+"UserGroup-label";var e="boxImg"+c;var h="editOptions"+b;var f="<div id='"+g+"' class='editGroup userGroup' groupId='"+b+"' onmouseover=\"editGroupMouseOver('"+h+"');\" onmouseout=\"editGroupMouseOut('"+h+"');\" ><div class='header'><div class='left'><img id='"+e+"' src='"+imageBlobPath+"box.png' class='boxImg' />&nbsp;<div id='"+b+"_group' class='userGroupClickEdit' style='display: inline'>";f+="<a href='javascript:void(0);' onclick='SearchUserGroup("+b+', "'+a+'", "'+c+"\")' class='tipTitle' title='Click to view all from this Group'>"+a+"</a></div><span class='group-error-message'></span></div>";f+="<div class='right";if(!isMobile){f+=" hidden"}f+="' id='"+h+"'><a class='minImage' href='javascript:void(0);' onclick=\"ToggleGroup(this, '"+c+"');\"/></a>&nbsp;<a class='cogImage' href='javascript:void(0);' onclick='EditGroup("+b+', "'+a+'", "'+c+"\");' /></a></div><div class='clear'></div></div><br />";f+="<div id='"+c+"' style='margin-left:15px;'>";$.each(i.Feeds,function(j){var k=GetFavouriteHtml(this,b,a);f+=k});f+="</div>";if(i.Feeds.length==0){f+="<div id='"+d+"' class='emptyGroupText'>"+emptyGroupText+"</div>"}f+="<div class='clear'></div></div>";return f}function editGroupMouseOver(a){$("#"+a).removeClass("hidden")}function editGroupMouseOut(a){$("#"+a).addClass("hidden")}function GetUserGroupDropdownHtml(b,a){if(a==-1){return"<option style='color:#0093D9;' value='"+a+"'>"+b+"</option>"}return"<option value='"+a+"'>"+b+"</option>"}function RemoveFromGroup(b,a){ClearSearch();ClearFavourite();ShowLoader();$.ajax({type:"POST",url:"FeedSearchServiceExporter.asmx/RemoveFeedFromGroup",data:{feedId:a,groupId:b},success:OnRemoveFromGroupSuccess,error:function(e,c,d){HideLoader()}})}function OnRemoveFromGroupSuccess(a,b){GetUserGroups();HideLoader()}function DeleteUserGroup(a){ShowLoader();$.ajax({type:"POST",url:"FeedSearchServiceExporter.asmx/DeleteUserGroup",data:{groupId:a},success:OnDeleteUserGroupSuccess,error:function(d,b,c){HideLoader()}})}function OnDeleteUserGroupSuccess(a,b){GetUserGroups();HideLoader()}function SearchUserGroup(b,c,a){window.scroll(0,0);if(b==groupSelectedId){ClearSearch();return}SetDefaultSearchText();$(".fav-img","#fav-wrapper").removeClass("selected");ShowLoader();favSelected=false;groupSelected=true;groupSelectedName=c;groupSelectedId=b;$(".fav-img","#"+a).addClass("selected");$("#favSelectedLabel").html("Group: "+c);$("#favSelectedLabel").addClass("selectedFavourite");$.ajax({type:"POST",url:"FeedSearchServiceExporter.asmx/SearchUserGroup",data:{groupId:b},success:OnUserFeedSearchSuccess,error:OnSearchUserGroupError})}function OnSearchUserGroupError(c,a,b){}function GetRecentlyAdded(){$.ajax({type:"POST",url:"FeedSearchServiceExporter.asmx/GetRecentlyAddedFeeds",data:{},success:OnGetRecentlyAddedSuccess,error:function(c,a,b){}})}function OnGetRecentlyAddedSuccess(b,c){var a=b.documentElement.childNodes[0].wholeText?b.documentElement.childNodes[0].wholeText:b.documentElement.childNodes[0].data;var b=$.parseJSON(a);$("#recentlyAdded-items").html("");if(b.length==0){$("#recentlyAddedLabel").removeClass("hidden");$("#recentlyAddedLabel").html("You have not added any feeds.")}else{$("#recentlyAddedLabel").addClass("hidden")}$.each(b,function(d){var e=GetFavouriteHtml(this,-1,"Recent");$(e).appendTo("#recentlyAdded-items");$("#favRecent"+this.FeedId).draggable({containment:$("#fav-wrapper"),cursor:"move",revert:true,helper:"clone",start:handleFavDragStart})});if(!isMobile){$(".fav-img").tipTip({edgeOffset:5,delay:0})}}function GetStaticFavouriteHtml(b){var a="fav"+b;var c="<div class='fav-img fav"+b+"' id='"+a+"' title='"+b+"'  style='margin:3px;' onmouseover=\"FavouriteMouseOver('"+b+"', '"+a+"');\" onmouseout='FavouriteMouseOut(\""+a+"\");'>";c+="<a href='javascript:void(0);' style='text-decoration:none;' onclick=\"SearchFavourite('"+b+"', '"+b+"');\">";c+="<img class='fav-img-img' src='"+mainLogoBlobPath+b+"-50x50.png' width='50px' height='50px'></a></div>";return c}function GetFavouriteHtml(e,c,f){var b=e.Parent+" "+e.Title;b=b.replace(/'/g,"&#39;");var a="fav"+f+e.FeedId;var d="<div class='fav-img fav"+e.FeedId+"' id='"+a+"' feedId='"+e.FeedId+"' title=\""+b+"\"  style='margin:3px;' onmouseover='FavouriteMouseOver(\""+b+'", "'+a+"\" );' onmouseout='FavouriteMouseOut(\""+a+"\");'>";d+="<a href='javascript:void(0);' style='text-decoration:none;' onclick='SearchFavourite("+e.FeedId+', "'+b+"\");'>";if(e.MainLogo.length>0){d+="<img class='fav-img-img' src='"+mainLogoBlobPath+e.MainLogo+"' width='50px' height='50px'>"}else{d+="<div class='fav-img-default'><br />"+b+"</div>"}if(c==0){d+="</a><a href='javascript:void(0);' onclick=\"UnFavouriteFeed('', '"+e.FeedId+"');\"><img class='deleteFav hidden' src='"+imageBlobPath+"close-hover.png' title='Remove from Favorites'></a></div>"}else{if(c>0){d+="</a><a href='javascript:void(0);' onclick=\"RemoveFromGroup("+c+", "+e.FeedId+");\"><img class='deleteFav hidden' src='"+imageBlobPath+"close-hover.png' title='Remove from Group: "+f+"'></a></div>"}else{d+="</a></div>"}}return d}function FavouriteMouseOver(b,a){$("#"+a).addClass("fav-img-hover");$("#favSelectedLabel").removeClass("selectedFavourite");$("#favSelectedLabel").html(b)}function FavouriteMouseOut(a){$("#"+a).removeClass("fav-img-hover");if(favSelected){$("#favSelectedLabel").html(favSelectedName);$("#favSelectedLabel").addClass("selectedFavourite")}else{if(groupSelected){$("#favSelectedLabel").html("Group: "+groupSelectedName);$("#favSelectedLabel").addClass("selectedFavourite")}else{$("#favSelectedLabel").html("")}}}function ClearFavourite(){$(".fav-img","#fav-wrapper").removeClass("selected");favSelected=false;favSelectedName=null;favSelectedId=null;groupSelected=false;groupSelectedName=null;groupSelectedId=null;$("#favSelectedLabel").html("");$("#favSelectedLabel").removeClass("selectedFavourite");if($("#userNotificationDiv")){$("#userNotificationDiv").css("display","none")}}function SearchFavourite(a,b){if(editingGroupId){return false}window.scroll(0,0);SetDefaultSearchText();ClearFavourite();if(favSelectedId&&a==favSelectedId){favSelected=false;favSelectedName=null;favSelectedId=null;$("#favSelectedLabel").removeClass("selectedFavourite");$("#userSearchResultContainer").addClass("hidden");$("#clearSearch").addClass("hidden");$("#resultCount").html("&nbsp;");return false}ShowLoader();groupSelected=false;favSelected=true;favSelectedName=b;favSelectedId=a;$(".fav"+a).addClass("selected");$("#favSelectedLabel").html(b);$("#favSelectedLabel").addClass("selectedFavourite");if(a=="Facebook"){GetFacebookStatuses(true)}else{if(a=="Twitter"){$.ajax({type:"POST",url:"FeedSearchServiceExporter.asmx/GetTweets",data:{},success:OnShowTweetsOnlySuccess,error:function(e,c,d){TwitterLoggedOut()}})}else{$.ajax({type:"POST",url:"FeedSearchServiceExporter.asmx/SearchFavourite",data:{feedId:a},success:OnUserFeedSearchSuccess,error:function(e,c,d){}})}}}function SetFavouriteFeed(a){window.scroll(0,0);$.ajax({type:"POST",url:"FeedSearchServiceExporter.asmx/SetFavouriteFeed",data:{feedId:a},success:OnSetFavouriteSuccess,error:function(d,b,c){}})}function OnSetFavouriteSuccess(b,a){GetFavouriteFeeds(true)}function UnFavouriteFeed(b,a){window.scroll(0,0);ClearSearch();ClearFavourite();$.ajax({type:"POST",url:"FeedSearchServiceExporter.asmx/RemoveFavouriteFeed",data:{feedId:a},success:OnUnFavouriteSuccess(b,a),error:function(e,c,d){}})}var OnUnFavouriteSuccess=function(b,a){return function(c,d){GetFavouriteFeeds(true)}};function EditFeedSettings(a){}function GetFeedUpdates(){updateRequestInProgress=true;ShowLoader();$.ajax({type:"POST",url:"FeedSearchServiceExporter.asmx/GetFeedUpdates",data:{lastAddedDate:lastAddedDate},success:OnGetFeedUpdatesSuccess,error:OnGetFeedUpdatesError})}function OnGetFeedUpdatesSuccess(d,a){try{var c=d.documentElement.childNodes[0].wholeText?d.documentElement.childNodes[0].wholeText:d.documentElement.childNodes[0].data;var d=$.parseJSON(c);$.each(d,function(e){if(e==d.length-1){lastAddedDate=this.AddedDate}var f=GetFeedItemHtml(this,true);$(f).prependTo("#mainentries");$("#rolio").effect("highlight",{padding:"3px 0 3px 0"},3000);$(".draggableFeed").draggable({cursor:"move",revert:true,helper:"clone",start:handleFavDragStart})});ProcessTooltipAndTimestamp();HideLoader();itemsOnScreen=itemsOnScreen+d.length;BindContextMenus();updateRequestInProgress=false}catch(b){updateRequestInProgress=false}}function OnGetFeedUpdatesError(c,a,b){HideLoader();updateRequestInProgress=false}function GetFeedItemHtml(b,e){var c=b.Parent+" "+b.FeedTitle;c=c.replace(/'/g,"&#39;");c=$.trim(c);var a=$.trim(b.Link);if(e){var d="<div class='msg' id='rolio'"}else{var d="<div class='msg'"}d+=" time='"+b.ShortAddedDate+"' feedId='"+b.FeedId+"' fullDate='"+b.AddedDate+"'";if(!isMobile){d+=" onmouseover=\"$('#contextMouseover', this).removeClass('hidden');\" onmouseout=\"$('#contextMouseover', this).addClass('hidden');\""}d+="><div class='msg-src'><img src='"+imageBlobPath+"rss.png' width='20' height='20' alt='RSS'><span id='contextMouseover'";if(!isMobile){d+=" class='hidden'"}if(jQuery.inArray(b.FeedId,favouriteFeedsArray)==-1){d+="><span class='feedSettingsContextMenu_favourite' feedId='"+b.FeedId+"' title='Feed settings'><a class='cogImage' href='javascript:void(0);'></a></span>"}else{d+="><span class='feedSettingsContextMenu_unfavourite' feedId='"+b.FeedId+"' title='Feed settings'><a class='cogImage' href='javascript:void(0);'></a></span>"}d+="<span class='shareContextMenu' feedLink='"+a+"' feedTitle='"+b.Title+"' title='Share'><a class='shareImage' href='javascript:void(0);'></a></span></span></div>";d+="<div class='msg-img draggableFeed' title=\""+c+"\" feedId='"+b.FeedId+"'><a href='"+a+"' target='_blank'>";d+="<img src='"+b.ImageUrl+"' width='50px' class='msg-img-img' ></a></div><div class='msg-txt'><div class='title'><a href='"+a+"'";if(isMobile){d+=" onclick='RegisterClick("+b.FeedId+', "'+a+'", "'+b.AddedDate+"\");'"}else{d+=" onmousedown='RegisterClick("+b.FeedId+', "'+a+'", "'+b.AddedDate+"\");'"}d+=" target='_blank'>"+b.Title+"</a></div>";d+="<div class='clear'></div>"+$.trim(b.Description)+"<div class='sub-msg'><br />";d+="<a href='javascript:void(0);' onclick='SearchFavourite("+b.FeedId+', "'+c+"\", \"recentlyAddedLabel\");' class='sub-msg-img draggableFeed' feedId='"+b.FeedId+"' title=\"Click to view more from "+c+', or drag into a Group">';if(b.Logo.length>0){d+="<img src='"+logoBlobPath+b.Logo+"' ></a>"}else{d+=c+"</a>"}d+="<div class='prettyDate' time='"+b.ShortAddedDate+"'></div></div>";return d}function GetTrendItemHtml(b){var c=b.Parent+" "+b.FeedTitle;c=c.replace(/'/g,"&#39;");c=$.trim(c);var a=$.trim(b.Link);var d="<div class='trendItem' time='"+b.ShortAddedDate+"' feedId='"+b.FeedId+"'>";d+="<div class='msg-src'><img src='"+imageBlobPath+"rss.png' width='20' height='20' alt='RSS'></div>";d+="<div class='fav-img' title=\""+c+"\" feedId='"+b.FeedId+"'>";d+="<img src='"+b.ImageUrl+"' width='50' style='max-height:50px' class='addFeedIcon'>";if(jQuery.inArray(b.FeedId,_userFeedsArray)==-1){d+="<a id='addFeedOverlay"+b.FeedId+"' href='javascript:void(0);' onclick='SubscribeToFeed("+b.FeedId+', "'+c+'", "",'+true+","+true+");'><img id='addFeedOverlayImage"+b.FeedId+"' class='addFeed hidden' src='"+imageBlobPath+"plus.png' title='Subscribe to "+c+"'></a>"}d+="</div><div class='trend-txt'><div class='title'><a href='"+a+"' onclick='RegisterClick("+b.FeedId+', "'+a+'", "'+b.AddedDate+"\");' target='_blank'>"+b.Title+"</a></div>";d+="<div class='clear'></div>"+$.trim(b.Description)+"<div class='sub-msg'><br />";d+="<a href='javascript:void(0);' onclick='SearchFavourite("+b.FeedId+', "'+c+"\", \"recentlyAddedLabel\");' class='sub-msg-img' feedId='"+b.FeedId+"' title=\"Click to view more from "+c+'">';if(b.Logo.length>0){d+="<img src='"+logoBlobPath+b.Logo+"' ></a>"}else{d+=c+"</a>"}d+="<div class='prettyDate' time='"+b.ShortAddedDate+"'></div></div>";return d}function RegisterClick(a,b,c){$.ajax({type:"POST",url:"FeedSearchServiceExporter.asmx/RegisterFeedItemClick",data:{feedId:a,link:b,addedDate:c},success:function(e,d){},error:OnRegisterClickError})}function OnRegisterClickError(c,a,b){}function FeedItemMouseover(b,a){$("div",b).removeClass("hidden");$(b).addClass("highlightFeedItem")}var txtUserFeedSearchTimer;function UserFeedSearchTextChanged(b){$("#x").fadeIn();if($.trim($("#txtUserFeedSearchInput").val())==""){$("#x").fadeOut()}var a=b.keyCode;if(a==13){return false}if(a==27){ClearSearch();return true}if((a==9)||(a==16)||(a==17)||(a==13)||(a>=33&&a<=40)){return true}window.scroll(0,0);if(txtUserFeedSearchTimer!=null){window.clearTimeout(txtUserFeedSearchTimer)}txtUserFeedSearchTimer=window.setTimeout(UserFeedSearch,500)}function ClearSearch(){window.scroll(0,0);$("#userSearchResultContainer").addClass("hidden");$("#userSearchResultsPlaceHolder").html("");$("#clearSearch").addClass("hidden");$("#resultCount").html("&nbsp;");ClearContextMenu();SetDefaultSearchText();SetDefaultWizardSearchText();$("#x").fadeOut();$("#xWizard").fadeOut();ClearFavourite();CloseFavGroupEdit();ClearWizard();CloseHelp()}function ClearContextMenu(){pauseUpdates=false;if($get("jqContextMenu")){$get("jqContextMenu").style.display="none"}if($get("contextEdit")){$get("contextEdit").style.background="";$get("contextEdit").id=""}}function UserSearchClicked(a){if(a.value==defaultSearchText){a.value=""}}function UserSearchBlur(a){if(a.value==""){SetDefaultSearchText()}}function SetDefaultSearchText(){$get("txtUserFeedSearchInput").value=defaultSearchText;$get("txtUserFeedSearchInput").blur()}function UserFeedSearch(){$("#userSearchResultContainer").addClass("hidden");$("#userSearchResultsPlaceHolder").html("");$("#clearSearch").addClass("hidden");$("#resultCount").html("&nbsp;");ClearFavourite();var a=$get("txtUserFeedSearchInput").value;if(a.length>1&&a!=defaultSearchText){$("#x").fadeIn();ShowLoader();$.ajax({type:"POST",url:"FeedSearchServiceExporter.asmx/SearchUserFeeds",data:{searchText:a},success:OnUserFeedSearchSuccess,error:OnUserFeedSearchError})}else{$("#x").fadeOut()}}function OnUserFeedSearchSuccess(c,a){$("#userSearchResultsPlaceHolder").html("");var b=c.documentElement.childNodes[0].wholeText?c.documentElement.childNodes[0].wholeText:c.documentElement.childNodes[0].data;var c=$.parseJSON(b);$.each(c,function(d){var e=GetFeedItemHtml(this,false);$(e).appendTo("#userSearchResultsPlaceHolder");$(".draggableFeed").draggable({cursor:"move",revert:true,helper:"clone",start:handleFavDragStart})});ProcessTooltipAndTimestamp();HideLoader();$("#clearSearch").removeClass("hidden");$("#resultCount").removeClass("hidden");if(c.length>0){$("#userSearchResultContainer").removeClass("hidden");if(c.length==defaultItemsCount){$("#resultCount").html("Showing "+defaultItemsCount+" most recent results")}else{$("#resultCount").html("Showing "+c.length+" results")}$("#userSearchResultsPlaceHolder").fadeIn("slow");$("#userSearchResultContainer").effect("slide",{},500);BindContextMenus()}else{$("#resultCount").html("Sorry, there are no matching results found in the last two weeks")}}function OnUserFeedSearchError(c,a,b){}function ShowMoreFeedsClicked(){ShowBottomLoader();$.ajax({type:"POST",url:"FeedSearchServiceExporter.asmx/ShowMoreFeeds",data:{oldestAddedDate:oldestAddedDate},success:OnShowMoreSuccess,error:OnShowMoreError})}function OnShowMoreSuccess(c,a){var b=c.documentElement.childNodes[0].wholeText?c.documentElement.childNodes[0].wholeText:c.documentElement.childNodes[0].data;var c=$.parseJSON(b);$.each(c,function(d){if(d==c.length-1){oldestAddedDate=this.AddedDate}var e=GetFeedItemHtml(this,false);$(e).appendTo("#mainentries");$(".draggableFeed").draggable({cursor:"move",revert:true,helper:"clone",start:handleFavDragStart})});ProcessTooltipAndTimestamp();HideBottomLoader();$("#mainentries").fadeIn("slow");BindContextMenus();window.scrollBy(0,50);itemsOnScreen=itemsOnScreen+c.length;GetTweets();GetFacebookStatuses(false)}function OnShowMoreError(c,a,b){HideBottomLoader()}function UnsubscribeFeedFromCog(a){$.ajax({type:"POST",url:"FeedSearchServiceExporter.asmx/UnsubscribeFeed",data:{feedId:a},success:OnUnsubscribeFeedFromCogSuccess(a),error:function(d,b,c){}})}var OnUnsubscribeFeedFromCogSuccess=function(a){return function(b,c){ClearSearch();StreamOnLoad();_userFeedsArray.splice($.inArray(parseInt(a),_userFeedsArray),1);myFeedCount=_userFeedsArray.length;$("#myFeedCount").html(myFeedCount)}};function BindContextMenus(){$("span.feedSettingsContextMenu_favourite").contextMenu("myMenu_favourite",{bindings:{unsubscribe:function(a){UnsubscribeFeedFromCog(a.attributes.feedId.value)},favourite:function(a){SetFavouriteFeed(a.attributes.feedId.value)}}});$("span.feedSettingsContextMenu_unfavourite").contextMenu("myMenu_unfavourite",{bindings:{unsubscribe2:function(a){UnsubscribeFeedFromCog(a.attributes.feedId.value)},unfavourite:function(a){UnFavouriteFeed(a,a.attributes.feedId.value)}}});$("span.shareContextMenu").contextMenu("myMenu_share",{bindings:{facebook:function(b){var c=encodeURIComponent(b.attributes.feedLink.value);var d=encodeURIComponent(b.attributes.feedTitle.value);var a="https://www.facebook.com/sharer.php?app_id=225883874151506&u="+c+"&t="+d;window.open(a,"fbShareWindow","height=400px, width=700px")},twitter:function(b){var a="https://twitter.com/share?url="+encodeURIComponent(b.attributes.feedLink.value);window.open(a,"twitterShareWindow","height=400px, width=700px")},google:function(b){var a="https://plusone.google.com/share?url="+encodeURIComponent(b.attributes.feedLink.value);window.open(a,"googleShareWindow","height=400px, width=700px")},linkedIn:function(b){var a="https://www.linkedin.com/cws/share?url="+encodeURIComponent(b.attributes.feedLink.value)+"&original_referer=http%3A%2F%2Fwww.rolio.com";window.open(a,"linkedInShareWindow","height=400px, width=700px")}}})}function InsertFeedToGroup(b){var a=$get("contextEdit").attributes.feedId.value;if(!selectedUserGroupId){var c=$get(b);selectedUserGroupId=c.options[c.selectedIndex].value}InsertFeedToGroupById(a,selectedUserGroupId)}function InsertFeedToGroupById(a,b){ClearContextMenu();ShowLoader();if(b==-1){feedToAddToNewGroup=a;$("#newGroup").unbind("click.editable");$("#newGroup").editable("FeedSearchServiceExporter.asmx/SaveUserGroupName",{indicator:"<img src='"+imageBlobPath+"mainloader_0093D9.gif'>",tooltip:"Click to create new group...",style:"inherit",width:"130px",onreset:editableOnReset,onsubmit:function(d,c){if(isGroupNameValid(c)){return true}else{return false}},submitdata:{feedNewGroup:a},data:function(d,c){return""},callback:function(d,c){$("#newGroup").unbind("click.editable");$("#newGroup").editable("FeedSearchServiceExporter.asmx/SaveUserGroupName",{indicator:"<img src='"+imageBlobPath+"mainloader_0093D9.gif'>",tooltip:"Click to create new group...",style:"inherit",width:"130px",onreset:editableOnReset,onsubmit:function(f,e){if(isGroupNameValid(e)){return true}else{return false}},submitdata:{feedNewGroup:-1},data:function(f,e){return""},callback:function(f,e){GetUserGroups()}});GetUserGroups()}});$("#newGroup").click();return}$.ajax({type:"POST",url:"FeedSearchServiceExporter.asmx/InsertFeedToGroup",data:{feedId:a,groupId:b},success:OnInsertFeedToGroupSuccess,error:function(e,c,d){HideLoader()}})}function OnInsertFeedToGroupSuccess(a,b){GetUserGroups();HideLoader()}var selectedUserGroupId;function SetSelectedGroup(a){selectedUserGroupId=a.options[a.selectedIndex].value}$(document).ready(function(){$("#favouritesGroup").hover(function(){mouseInsideEditGroup="fav-items"},function(){mouseInsideEditGroup=null});$("body").mouseup(function(){var a=$(".userGroupClickEdit");$.each(a,function(b){$(this).unbind("click.editable")});if(editingGroupId&&editingGroupId!=mouseInsideEditGroup){CloseFavGroupEdit()}})});function EditGroup(b,d,c){if(editingGroupId!=null){CloseFavGroupEdit()}else{editingGroupId=c;groupObject=$get(c);$(".deleteFav",groupObject).removeClass("hidden");$(".fav-img-img",groupObject).addClass("opacity");$(".fav-img-default",groupObject).addClass("opacity");var a="boxImg"+c;if($get(a)){$get(a).src=imageBlobPath+"box_remove.png";$get(a).title="Delete this group";$get(a).onclick=function(e){DeleteUserGroup(b)};$("#"+a).addClass("pointer");$("#"+b+"_group").editable("FeedSearchServiceExporter.asmx/SaveUserGroupName",{indicator:"<img src='"+imageBlobPath+"mainloader_0093D9.gif'>",tooltip:"Click to edit...",style:"inherit",width:"130px",onreset:editableOnReset,onsubmit:function(f,e){if(isGroupNameValid(e)){return true}else{return false}},data:function(f,e){return d},submitdata:{feedNewGroup:-1},callback:function(f,e){$(this).unbind(e.event);GetUserGroups()}});$("#"+b+"_group").click()}}}function CloseFavGroupEdit(){if(editingGroupId){groupObject=$get(editingGroupId);$(".deleteFav",groupObject).addClass("hidden");$(".fav-img-img",groupObject).removeClass("opacity");$(".fav-img-default",groupObject).removeClass("opacity");var a="boxImg"+editingGroupId;if($get(a)){$get(a).src=imageBlobPath+"box.png";$get(a).title=null;$get(a).onclick=null;$("#"+a).removeClass("pointer")}editingGroupId=null}}function ToggleGroup(b,a){if((minimizeOverride&&b.innerHTML=="+")||(maximizeOverride&&b.innerHTML=="-")){return}$("#"+a).slideToggle("slow");ToggleLink(b)}function ToggleLink(a){if(a.className=="minImage"){$(a).removeClass("minImage");$(a).addClass("maxImage")}else{$(a).removeClass("maxImage");$(a).addClass("minImage")}}function GetTrends(){ShowLoader();$.ajax({type:"POST",url:"FeedSearchServiceExporter.asmx/GetTrends",data:{},success:OnGetTrendsSuccess,error:function(c,a,b){HideLoader()}})}function OnGetTrendsSuccess(c,a){var b=c.documentElement.childNodes[0].wholeText?c.documentElement.childNodes[0].wholeText:c.documentElement.childNodes[0].data;var c=$.parseJSON(b);$("#trend-items").html("");if(c.length>0){$.each(c,function(d){var e=GetTrendItemHtml(this,false);$(e).appendTo("#trend-items")});ProcessTrendTooltipAndTimestamp();$("#trendsPanel").fadeIn("slow");$("#trendsPanel").effect("highlight",{},3000)}else{$("#trendsPanel").addClass("hidden")}HideLoader()};