var menuState=new Array();var menuNames=new Array();var menusLoaded=0;var isMenuSearch;var subscriptionChanged=false;var searchResultIds=new Array();var myFeedCount=_userFeedsArray.length;var imageBlobPath="https://rws.blob.core.windows.net/images/";var logoBlobPath="https://rws.blob.core.windows.net/logo/";var mainLogoBlobPath="https://rws.blob.core.windows.net/mainlogo/";$.ajaxSetup({type:"POST",headers:{"cache-control":"no-cache"}});function LoadWizard(){window.scroll(0,0);ClearSearch();ResetWizard();LoadPopularFeeds();$("body").css("overflow","hidden");document.getElementById("wizardOverlay").style.display="block";document.getElementById("fade").style.display="block";$get("txtSearchInputWizard").value=defaultWizardSearchText;if(!isMobile){$(".searchTip").tipTip({edgeOffset:5})}$("#txtSearchInputWizard").keyup(function(){$("#xWizard").fadeIn();if($.trim($("#txtSearchInputWizard").val())==""){$("#xWizard").fadeOut()}});$("#xWizard").click(function(){$("#txtSearchInputWizard").val("");$(this).hide();ClearSearch()})}function CloseWizard(){if(_userFeedsArray.length==0){$("#wizardNotification").html("You must subscribe to at least one feed!");$("#wizardNotification").css("display","")}else{$("body").css("overflow","auto");document.getElementById("wizardOverlay").style.display="none";document.getElementById("fade").style.display="none";if(subscriptionChanged){StreamOnLoad()}if(_isNewUser=="True"){ShowHelp()}}}function ResetWizard(){subscriptionChanged=false;searchResultIds=new Array();ClearRelated();ResetMenu();ClearCantFind()}function ResetMenu(){menuState=new Array();menuNames=new Array();menuIndex=0;menusLoaded=0;var a=$.parseJSON(_categoryJSON);$("#wizardVerticalDoubleMenu").html("");$("#wizardVerticalMenu1").html("");$("#wizardVerticalMenu2").html("");$("#wizardVerticalDoubleMenu").css("display","");$("#wizardVerticalMenu1").css("display","none");$.each(a,function(b){var c=GetMenuItemHtml(this,0,b==0,"wizardVerticalMenu1");$("#wizardVerticalMenu1").append(c);$("#wizardVerticalDoubleMenu").append(c)});HideBackButton()}function ClearRelated(){$("#wizardResultsWrapper").css("height","485px");$("#related-header").css("display","none");$("#wizardNotification").css("display","none")}function ClearCantFind(){$("#tableNewFeedResults").css("display","none");$("#newFeedOutcomeTable").css("display","none")}function ClearWizard(){if(document.getElementById("wizardOverlay").style.display=="block"){ClearRelated();ResetMenu();LoadPopularFeeds()}}function ShowCantFind(){SetDefaultWizardSearchText();ClearMenu();ClearRelated();ResetMenu();$("#wizardSearchText").html("");$("#wizard-main-left").html("");$("#wizard-main-right").html("");$("#wizard-cant-find").css("display","");ClearCantFind()}function GetMenuItemHtml(e,g,f,b){var d=JSON.stringify(e.Children);var a=e.Children.length>0;var c="<li><a href='javascript:void(0)' children='"+d+"' onclick=\"MenuItemClicked(this, '"+e.Name+"', '"+b+"', "+g+');"';if(a){c+=" onmouseover='HighlightMenuItem(true, this)' onmouseout='UnhighlightMenuItem(true, this)'"}else{c+=" onmouseover='HighlightMenuItem(false, this)' onmouseout='UnhighlightMenuItem(false, this)'"}if(f){c+=" class='first'"}c+=">"+e.Name+"</a>";return c}function MenuItemClicked(d,e,b,a){ShowWizardLoader();SetDefaultWizardSearchText();ClearRelated();$("#related-header").css("display","none");$("#wizardResultsWrapper").css("height","485px");var c=$.parseJSON(d.attributes.children.value);ClearMenuSelection(d.parentElement.parentElement.id);if(c.length>0){$(d).addClass("selectedItemArrow")}else{$(d).addClass("selectedItem")}menuState[a]=d.parentElement.parentElement.innerHTML;menuNames[a]=e;ClearMenu(a+1);if(c.length>0){if(d.parentElement.parentElement.id=="wizardVerticalDoubleMenu"){$("#wizardVerticalMenu1").html($get("wizardVerticalDoubleMenu").innerHTML);$("#wizardVerticalDoubleMenu").css("display","none");$("#wizardVerticalMenu1").css("display","")}else{if(d.parentElement.parentElement.id=="wizardVerticalMenu2"){$("#wizardVerticalMenu1").html($get("wizardVerticalMenu2").innerHTML)}}LoadMenu2(c,a+1)}else{if(d.parentElement.parentElement.id=="wizardVerticalMenu1"){MenuBack()}}ShowBackButton();UpdateSearchText();SearchFeedsByCategory()}function ShowBackButton(){$("#wizard-back-link").css("display","")}function HideBackButton(){$("#wizard-back-link").css("display","none")}function ClearMenuSelection(a){$("a",$("#"+a)).each(function(){var b=$(this);b.removeClass("selectedItemArrow");b.removeClass("selectedItem");b.removeClass("hoverArrow");b.removeClass("hover")})}function LoadMenu2(b,a){$("#wizardVerticalMenu2").html("");$get("wizardVerticalMenu2").style.display="none";$.each(b,function(c){var d=GetMenuItemHtml(this,a,c==0,"wizardVerticalMenu2");$("#wizardVerticalMenu2").append(d)});$("#wizardVerticalMenu2").effect("slide",{},800);if(a>menusLoaded){menusLoaded=a}}function UpdateSearchText(){$get("wizardSearchText").innerHTML="";if(menuNames.length>0){$get("wizardSearchText").innerHTML+="<a href='javascript:void(0)' onclick='ClearWizard();'>Home</a>"}for(var a=0;a<menuNames.length;a++){if(menuNames[a]){var b=" >> ";if(a!=menuNames.length-1){b+="<a href='javascript:void(0)' onclick='BackToLevel("+a+")'>"+menuNames[a]+"</a>"}else{b+=menuNames[a]}$get("wizardSearchText").innerHTML+=b}}}function MenuBack(){ClearRelated();if(menusLoaded==0){ClearWizard();return}if(menusLoaded==1){$("#wizardVerticalDoubleMenu").html($get("wizardVerticalMenu1").innerHTML);$("#wizardVerticalDoubleMenu").css("display","");$("#wizardVerticalMenu1").css("display","none");$("#wizardVerticalMenu2").html("")}if(menusLoaded>1){$("#wizardVerticalMenu2").html($get("wizardVerticalMenu1").innerHTML);$("#wizardVerticalMenu2").effect("slide",{},800);$("#wizardVerticalMenu1").html(menuState[menusLoaded-2]);$("#wizardVerticalMenu1").effect("slide",{},800)}ClearMenu(menusLoaded);menusLoaded--;UpdateSearchText();SearchFeedsByCategory()}function BackToLevel(a){ClearRelated();if(a==0){$("#wizardVerticalDoubleMenu").html(menuState[a]);$("#wizardVerticalMenu1").html(menuState[a]);$("#wizardVerticalMenu2").html("");$("#wizardVerticalDoubleMenu").css("display","");$("#wizardVerticalMenu1").css("display","none")}else{$("#wizardVerticalMenu1").html(menuState[a-1]);$("#wizardVerticalMenu2").html(menuState[a])}ClearMenu(a+1);menusLoaded=a;UpdateSearchText();SearchFeedsByCategory()}function ClearMenu(a){for(var b=menuNames.length-1;b>=a;b--){menuNames.splice(b,1);menuState.splice(b,1)}}function LoadPopularFeeds(){$("#wizardSearchText").html("Popular Feeds");ShowWizardLoader();$.ajax({type:"POST",url:"FeedSearchServiceExporter.asmx/GetPopularFeeds",data:{},success:OnCategoryFeedSearchSuccess(false),error:function(c,a,b){}})}function SearchFeedsByCategory(){var b=menuNames[0];var a="";if(menuNames.length>1){a=menuNames[menuNames.length-1]}$.ajax({type:"POST",url:"FeedSearchServiceExporter.asmx/SearchFeedByCategory",data:{category1:b,category2:a},success:OnCategoryFeedSearchSuccess(true),error:function(e,c,d){}})}var OnCategoryFeedSearchSuccess=function(a){return function(c,d){isMenuSearch=a;$("#wizard-main-left").html("");$("#wizard-main-right").html("");$("#wizard-cant-find").css("display","none");searchResultIds=new Array();var b=c.documentElement.childNodes[0].wholeText?c.documentElement.childNodes[0].wholeText:c.documentElement.childNodes[0].data;var c=$.parseJSON(b);$.each(c,function(e){var f=GetFeedSearchResultHtml(this,false);searchResultIds.push(parseInt(this.ID));if(e%2==0){$("#wizard-main-left").append(f)}else{$("#wizard-main-right").append(f)}});if(c.length==0){$get("wizardSearchText").innerHTML+=" - Sorry, there were no results matching this search";$("#wizard-cant-find").css("display","block")}$get("wizardResultsWrapper").scrollTop=0;if(!isMobile){$(".subscribeImage").tipTip({edgeOffset:5,delay:0,defaultPosition:"right"});$(".descTitle").tipTip({edgeOffset:5,delay:0,defaultPosition:"right"})}HideWizardLoader()}};function GetFeedSearchResultHtml(m,k,e){var b=55;var g=75;var i=m.Parent.replace(/'/g,"&apos;").replace(/"/g,"&apos;");var h=m.Title.replace(/'/g,"&apos;").replace(/"/g,"&apos;");var l=i+" "+h;var a=(l.length>b)?l.substring(0,b)+"...":l;var c=m.Description.replace(/'/g,"&apos;").replace(/"/g,"&apos;");var j=c;var f=false;if(m.Description.length>g){j=m.Description.substring(0,g).replace(/'/g,"&apos;").replace(/"/g,"&apos;");f=true}var d="";if(k){d+="<div class='wizardRelatedResults' id='relFeed"+e+"' style='display:none;'>"}else{d+="<div class='wizardResults'>"}d+="<div class='fav-img'><span><img src='"+m.MainLogo+"' width='50' height='50'></span></div>";d+="<div class='wizardResults-txt'><div class='wizard-title'><div class='wizard-title-left'>"+a+"</div><div class='wizard-title-right'>";d+="<div class='add-remove right'>";if(jQuery.inArray(m.ID,_userFeedsArray)==-1){d+="<a id='wizSubscribeLink"+m.ID+"' class='subscribeLink"+m.ID+"' href='javascript:void(0);' onclick='SubscribeToFeed("+m.ID+', "'+l+'", "'+i+'",'+k+","+false+");'><img id='imgFeed"+m.ID+"' src='"+imageBlobPath+"plus.png' class='subscribeImage subscribeImage"+m.ID+"' title='Subscribe to "+l+"'></a></div>"}else{d+="<a id='wizUnsubscribeLink"+m.ID+"' class='subscribeLink"+m.ID+"' href='javascript:void(0);' onclick='UnsubscribeFeed("+m.ID+', "'+l+'", "'+i+'",'+k+");'><img id='imgFeed"+m.ID+"' src='"+imageBlobPath+"remove.png' class='subscribeImage subscribeImage"+m.ID+"' title='Already subscribed, Remove?'></a></div>"}d+="</div></div><div class='clear'></div>"+j;if(f){d+="<span class='descTitle' title='"+c+"'>...</span>"}d+="</div></div>";return d}function HighlightMenuItem(a,b){if(a){$(b).addClass("hoverArrow")}else{$(b).addClass("hover")}}function UnhighlightMenuItem(a,b){if(a){$(b).removeClass("hoverArrow")}else{$(b).removeClass("hover")}}function ShowWizardLoader(){$get("wizardloaderimg").style.display="inline-block"}function HideWizardLoader(){$get("wizardloaderimg").style.display="none"}function SubscribeToFeed(c,e,d,b,a){$("#wizardNotification").css("display","none");$(".subscribeImage"+c).each(function(){this.src=imageBlobPath+"plus-grey.png"});$(".subscribeLink"+c).each(function(){this.onclick=function(f){}});ShowWizardLoader();$.ajax({type:"POST",url:"FeedSearchServiceExporter.asmx/SubscribeToFeed",data:{feedID:c,feedCount:_userFeedsArray.length},success:OnSubscribeSuccess(c,e,d,b,a),error:OnSubscribeError(c,e,d,b)})}var OnSubscribeError=function(b,d,c,a){return function(g,e,f){if(_userFeedsArray.length>249){$("#wizardNotification").html("You cannot subscribe to more than 250 feeds");$("#wizardNotification").css("display","")}$(".subscribeImage"+b).each(function(){this.src=imageBlobPath+"plus.png"});$(".subscribeLink"+b).each(function(){this.onclick=function(h){SubscribeToFeed(b,d,c,a,false)}});HideWizardLoader()}};var OnSubscribeSuccess=function(c,e,d,b,a){return function(f,g){subscriptionChanged=true;if($get("popFeedImage"+c)){$get("popFeedImage"+c).src=imageBlobPath+"remove.png";$get("popFeedLink"+c).onclick=function(h){UnsubscribeFeed(c,e,d,b)};$get("popFeedImage"+c).title="Already subscribed, Remove?";if(!isMobile){$(".addFeed").tipTip({edgeOffset:5,delay:0,defaultPosition:"right"})}}if($(".subscribeImage"+c)){$(".subscribeImage"+c).each(function(){this.src=imageBlobPath+"remove.png";this.title="Already subscribed, Remove?"});$(".subscribeLink"+c).each(function(){this.onclick=function(h){UnsubscribeFeed(c,e,d,b)}});if(!isMobile){$(".subscribeImage").tipTip({edgeOffset:5,delay:0,defaultPosition:"right"})}}_userFeedsArray.push(parseInt(c));myFeedCount=_userFeedsArray.length;$("#myFeedCount").html(myFeedCount);if(a){ClearSearch();StreamOnLoad()}else{GetRelatedFeeds(c,d,b)}}};function UnsubscribeFeed(b,d,c,a){ShowWizardLoader();$(".subscribeImage"+b).each(function(){this.src=imageBlobPath+"remove-grey.png"});$(".subscribeLink"+b).each(function(){this.onclick=function(e){}});$.ajax({type:"POST",url:"FeedSearchServiceExporter.asmx/UnsubscribeFeed",data:{feedId:b},success:OnUnsubscribeFeedSuccess(b,d,c,a),error:OnUnSubscribeError(b,d,c,a)})}var OnUnsubscribeFeedSuccess=function(b,d,c,a){return function(e,f){subscriptionChanged=true;if($get("popFeedImage"+b)){$get("popFeedImage"+b).src=imageBlobPath+"plus.png";$get("popFeedImage"+b).title="Subscribe to "+d;$get("popFeedLink"+b).onclick=function(g){SubscribeToFeed(b,d,c,a,false)};if(!isMobile){$(".addFeed").tipTip({edgeOffset:5,delay:0,defaultPosition:"right"})}}if($(".subscribeImage"+b)){$(".subscribeImage"+b).each(function(){this.src=imageBlobPath+"plus.png";this.title="Subscribe to "+d});$(".subscribeLink"+b).each(function(){this.onclick=function(g){SubscribeToFeed(b,d,c,a,false)}});if(!isMobile){$(".subscribeImage").tipTip({edgeOffset:5,delay:0,defaultPosition:"right"})}}_userFeedsArray.splice($.inArray(parseInt(b),_userFeedsArray),1);myFeedCount=_userFeedsArray.length;$("#myFeedCount").html(myFeedCount);HideWizardLoader()}};var OnUnSubscribeError=function(b,d,c,a){return function(g,e,f){$(".subscribeImage"+b).each(function(){this.src=imageBlobPath+"remove.png"});$(".subscribeLink"+b).each(function(){this.onclick=function(h){UnsubscribeFeed(b,d,c,a)}});HideWizardLoader()}};var txtBxTimer;var defaultWizardSearchText="e.g. music, tennis, finance, gossip...";function SearchTextChanged(b){var a=b.keyCode;if(a==13){return false}if((a==9)||(a==16)||(a==17)||(a==13)||(a>=33&&a<=40)){return true}if(txtBxTimer!=null){window.clearTimeout(txtBxTimer)}txtBxTimer=window.setTimeout(Search,500)}function Search(){var a=$get("txtSearchInputWizard").value;if(a.length>1&&a!=defaultWizardSearchText){ClearRelated();$("#wizard-main-left").html("");$("#wizard-main-right").html("");$("#wizard-cant-find").css("display","none");ShowWizardLoader();$("#wizardSearchText").html("Search: '"+a+"'");$.ajax({type:"POST",url:"FeedSearchServiceExporter.asmx/SearchFeeds",data:{searchText:a},success:OnCategoryFeedSearchSuccess(false),error:OnSearchError});if($get("wizardVerticalDoubleMenu").style.display=="none"){ResetMenu()}else{ClearMenuSelection("wizardVerticalDoubleMenu")}}}function OnSearchError(c,a,b){HideWizardLoader()}function WizardUserSearchClicked(a){if(a.value==defaultWizardSearchText){a.value=""}}function WizardUserSearchBlur(a){if(a.value==""){SetDefaultWizardSearchText()}}function SetDefaultWizardSearchText(){$get("txtSearchInputWizard").value=defaultWizardSearchText;$get("txtSearchInputWizard").blur()}function SetEmptyWizardSearchText(){$get("txtSearchInputWizard").value="";$get("txtSearchInputWizard").focus()}function ClearWizardSearch(){$("#wizard-main-left").html("");$("#wizard-main-right").html("");$("#wizard-cant-find").css("display","none");SetEmptyWizardSearchText();$("#xQizard").fadeOut()}function GetRelatedFeeds(b,c,a){if(!a){if(isMenuSearch){GetRelatedByParent(b,c)}else{GetRelatedByCategory(b)}}else{HideWizardLoader()}}function GetRelatedByCategory(a){$.ajax({type:"POST",url:"FeedSearchServiceExporter.asmx/GetRelatedFeedsByCategory",data:{feedId:a},success:OnGetRelatedSuccess,error:function(d,b,c){HideWizardLoader()}})}function GetRelatedByParent(a,b){$.ajax({type:"POST",url:"FeedSearchServiceExporter.asmx/GetRelatedFeedsByParent",data:{feedId:a,parent:b},success:OnGetRelatedSuccess,error:function(e,c,d){HideWizardLoader()}})}var carouselCount=0;var carouselIndex=0;function OnGetRelatedSuccess(d,a){$("#related-header-left").html("");$("#related-header-right").html("");$("#carousel").html("");var c=0;carouselCount=0;carouselIndex=0;var b=d.documentElement.childNodes[0].wholeText?d.documentElement.childNodes[0].wholeText:d.documentElement.childNodes[0].data;var d=$.parseJSON(b);if(d.length>0){$.each(d,function(e){if(jQuery.inArray(this.ID,searchResultIds)==-1){var f=GetFeedSearchResultHtml(this,true,c);if(c%2==0){$("#related-header-left").append(f);var g="";if(carouselCount==0){g="<a href='javascript:void(0);' id='carouselIndex0' onclick='CarouselClick(0);' class='selectedIndex'>1</a>&nbsp;"}else{g="<a href='javascript:void(0);' id='carouselIndex"+carouselCount+"' onclick='CarouselClick("+carouselCount+");'>"+(carouselCount+1)+"</a>&nbsp;"}$("#carousel").append(g);carouselCount++}else{$("#related-header-right").append(f)}c++}});if(c>0){$("#relFeed0").css("display","");$("#relFeed1").css("display","");$("#wizardResultsWrapper").animate({height:"400px"},800,function(){$("#related-header").css("display","")});if(c>2){$("#carousel").prepend("<a href='javascript:void(0);' onclick='CarouselPreviousClick();'><</a>&nbsp;");$("#carousel").append("<a href='javascript:void(0);' onclick='CarouselNextClick();'>></a>")}}else{ClearRelated()}if(!isMobile){$(".subscribeImage").tipTip({edgeOffset:5,delay:0,defaultPosition:"right"});$(".descTitle").tipTip({edgeOffset:5,delay:0,defaultPosition:"right"})}}else{ClearRelated()}HideWizardLoader()}function CarouselClick(a){$(".wizardRelatedResults").css("display","none");$("a",$("#carousel")).removeClass("selectedIndex");$("#carouselIndex"+a).addClass("selectedIndex");$("#relFeed"+(a*2)).effect("slide",{direction:"right"},800);$("#relFeed"+((a*2)+1)).effect("slide",{direction:"right"},800);carouselIndex=a}function CarouselNextClick(){if(carouselIndex+1<carouselCount){CarouselClick(carouselIndex+1)}}function CarouselPreviousClick(){if(carouselIndex-1>=0){CarouselClick(carouselIndex-1)}}var page;function LoadMyFeeds(){window.scroll(0,0);ClearSearch();page=1;subscriptionChanged=false;GetMyFeeds();$("#myFeedCount").html(myFeedCount);$("body").css("overflow","hidden");document.getElementById("myFeedsOverlay").style.display="block";document.getElementById("fade").style.display="block"}function CloseMyFeeds(){$("body").css("overflow","auto");document.getElementById("myFeedsOverlay").style.display="none";document.getElementById("fade").style.display="none";if(subscriptionChanged){StreamOnLoad()}}function ShowMyFeedsLoader(){$get("myFeedsLoaderImg").style.display="inline-block"}function HideMyFeedsLoader(){$get("myFeedsLoaderImg").style.display="none"}function GetMyFeeds(){ShowMyFeedsLoader();$("#show-more-feeds").css("display","none");$.ajax({type:"POST",url:"FeedSearchServiceExporter.asmx/GetMyFeeds",data:{page:page},success:OnGetMyFeedSuccess(page),error:function(c,a,b){HideMyFeedsLoader()}})}var OnGetMyFeedSuccess=function(a){return function(c,d){if(a==1){$("#my-feeds-main").html("")}var b=c.documentElement.childNodes[0].wholeText?c.documentElement.childNodes[0].wholeText:c.documentElement.childNodes[0].data;var c=$.parseJSON(b);if(c.length>0){$.each(c,function(e){var f=GetMyFeedHtml(this);$("#my-feeds-main").append(f)});if(!isMobile){$(".subscribeImage").tipTip({edgeOffset:5,delay:0,defaultPosition:"right"});$(".descTitle").tipTip({edgeOffset:5,delay:0,defaultPosition:"right"})}}if(c.length==50){$("#show-more-feeds").css("display","")}HideMyFeedsLoader()}};function ShowMoreMyFeeds(){page++;GetMyFeeds()}function GetMyFeedHtml(k){var b=75;var f=175;var h=k.Parent.replace(/'/g,"&apos;").replace(/"/g,"&apos;");var g=k.Title.replace(/'/g,"&apos;").replace(/"/g,"&apos;");var j=h+" "+g;var a=(j.length>b)?j.substring(0,b)+"...":j;var c=k.Description.replace(/'/g,"&apos;").replace(/"/g,"&apos;");var i=c;var e=false;if(k.Description.length>f){i=k.Description.substring(0,f).replace(/'/g,"&apos;").replace(/"/g,"&apos;");e=true}var d="<div class='myfeeds'><div class='myfeeds-src'>";d+="<a id='myFeedsSubscribeLink"+k.ID+"' class='subscribeLink"+k.ID+"' href='javascript:void(0);' onclick='UnsubscribeFeed("+k.ID+', "'+j+'", "'+h+"\",false);'><img id='imgFeed"+k.ID+"' src='"+imageBlobPath+"remove.png' class='subscribeImage subscribeImage"+k.ID+"' title='Already subscribed, Remove?'></a></div>";d+="<div class='myfeeds-img'><img src='"+k.MainLogo+"' width='40' height='40'></div>";d+="<div class='myfeeds-txt'><div class='title-txt'>"+a+"</div>";d+="<div class='clear'></div>"+i;if(e){d+="<span class='descTitle' title='"+c+"'>...</span>"}d+="</div></div>";return d}function ShowHelp(){$("#myRolioHeaderLink").click();window.scroll(0,0);ClearSearch();$("body").css("overflow","hidden");$get("helpOverlay").style.display="block";$get("fade").style.display="block"}function CloseHelp(){if($get("helpOverlay").style.display=="block"){$("body").css("overflow","auto");$get("helpOverlay").style.display="none";$get("fade").style.display="none";_isNewUser="False"}}function ShowCleanUpOverlay(){CloseMyFeeds();CloseHelp();CloseSettingsOverlay();CloseReferral();CloseWizard();window.scroll(0,0);$("body").css("overflow","hidden");$get("pageCleanUpOverlay").style.display="block";$get("fade").style.display="block";StartCleanupCountdown()}function StartCleanupCountdown(){window.clearInterval(cleanupTimer);$("#cleanupCountdown").html("8");cleanupTimer=window.setInterval(function(){var timeCounter=$("#cleanupCountdown").html();var updateTime=eval(timeCounter)-eval(1);$("#cleanupCountdown").html(updateTime);if(updateTime==0){CleanUpPage()}},1000)}function CloseCleanUpOverlay(){if($get("pageCleanUpOverlay").style.display=="block"){$("body").css("overflow","auto");$get("pageCleanUpOverlay").style.display="none";$get("fade").style.display="none"}}function ShowSettingsOverlay(){window.scroll(0,0);$get("txtOldPassword").value="";$get("txtNewPassword").value="";$get("txtNewPasswordConfirm").value="";$("#lblChangePwdResult").html("");$("#txtOldPasswordDummy").removeClass("formInputError");$("#txtOldPassword").removeClass("formInputError");$("#txtNewPasswordDummy").removeClass("formInputError");$("#txtNewPassword").removeClass("formInputError");$("#txtNewPasswordConfirmDummy").removeClass("formInputError");$("#txtNewPasswordConfirm").removeClass("formInputError");$("#txtOldPassword").blur();$("#txtNewPassword").blur();$("#txtNewPasswordConfirm").blur();$("body").css("overflow","hidden");$get("settingsOverlay").style.display="block";$get("fade").style.display="block";StartCleanupCountdown()}function CloseSettingsOverlay(){if($get("settingsOverlay").style.display=="block"){$("body").css("overflow","auto");$get("settingsOverlay").style.display="none";$get("fade").style.display="none"}}$(document).ready(function(){$("#txtOldPasswordDummy").focus(function(){$("#txtOldPasswordDummy").hide();$("#txtOldPassword").show();$("#txtOldPassword").focus()});$("#txtOldPassword").blur(function(){if($("#txtOldPassword").val()==""){$("#txtOldPasswordDummy").show();$("#txtOldPassword").hide()}});$("#txtNewPasswordDummy").focus(function(){$("#txtNewPasswordDummy").hide();$("#txtNewPassword").show();$("#txtNewPassword").focus()});$("#txtNewPassword").blur(function(){if($("#txtNewPassword").val()==""){$("#txtNewPasswordDummy").show();$("#txtNewPassword").hide()}});$("#txtNewPasswordConfirmDummy").focus(function(){$("#txtNewPasswordConfirmDummy").hide();$("#txtNewPasswordConfirm").show();$("#txtNewPasswordConfirm").focus()});$("#txtNewPasswordConfirm").blur(function(){if($("#txtNewPasswordConfirm").val()==""){$("#txtNewPasswordConfirmDummy").show();$("#txtNewPasswordConfirm").hide()}})});function ValidateChangePwd(){$("#lblChangePwdResult").html("");$("#txtOldPasswordDummy").removeClass("formInputError");$("#txtOldPassword").removeClass("formInputError");$("#txtNewPasswordDummy").removeClass("formInputError");$("#txtNewPassword").removeClass("formInputError");$("#txtNewPasswordConfirmDummy").removeClass("formInputError");$("#txtNewPasswordConfirm").removeClass("formInputError");var c=/^[a-z0-9]+$/i;var b=$get("txtOldPassword").value;var d=$get("txtNewPassword").value;var a=$get("txtNewPasswordConfirm").value;if(b.length==0){$("#txtOldPasswordDummy").addClass("formInputError");$("#lblChangePwdResult").html("Please enter your old password.");return false}if(d.length<3){$("#lblChangePwdResult").html("Password must be at least 3 characters.");if(d.length==0){$("#txtNewPasswordDummy").addClass("formInputError")}else{$("#txtNewPassword").addClass("formInputError")}return false}if(a.length<3){$("#lblChangePwdResult").html("Please confirm your password.");if(a.length==0){$("#txtNewPasswordConfirmDummy").addClass("formInputError")}else{$("#txtNewPasswordConfirm").addClass("formInputError")}return false}if(d.length>30){$("#lblChangePwdResult").html("Password too long.");$("#txtNewPassword").addClass("formInputError");return false}if(password.indexOf("<")!=-1){$("#lblChangePwdResult").html('Password cannot contain "<".');$("#txtNewPassword").addClass("formInputError");return false}if(d!=a){$("#lblChangePwdResult").html("Passwords do not match.");$("#txtNewPassword").addClass("formInputError");$("#txtNewPasswordConfirm").addClass("formInputError");return false}return true}function ShowReferral(){$get("txtEmailReferList").value="";$("#lblReferResult").html("");$get("checkCloneOption").checked=false;window.scroll(0,0);$("body").css("overflow","hidden");$get("referralOverlay").style.display="block";$get("fade").style.display="block";$("#fbRecommendSpan").html('<div class="fb-like" data-href="http://www.rolio.com" data-send="false" data-width="400" data-show-faces="false" data-action="recommend"></div>');FB.XFBML.parse()}function CloseReferral(){if($get("referralOverlay").style.display=="block"){$("body").css("overflow","auto");$get("referralOverlay").style.display="none";$get("fade").style.display="none"}}function ValidateEmailList(){var b="";$get("hiddenValidEmail").value="";$("#lblReferResult").html("");var c=/^([\w\.-]+@([\w-]+\.)+[\w-]{2,4})?$/;var a=$get("txtEmailReferList").value.replace(/[^,;]*.?</g,"").replace(/>/g,"").replace(/[,; ]{1,}/g,"\n").replace(/[\n]{2,}/g,"\n").split("\n");$.each(a,function(d){if(this.length>0&&c.test(this)){b+=this+";"}});if(b.length==0){$("#lblReferResult").html("Please enter a valid email address.");return false}if(b.length>50){$("#lblReferResult").html("Sorry, your email list size must be less than 50, size ="+b.length);return false}$get("hiddenValidEmail").value=b;ShowReferralLoader();return true}function ShowReferralLoader(){$get("referralLoaderImg").style.display="inline-block"}function HidReferralLoader(){$get("referralLoaderImg").style.display="none"}function ReferFromMyFeeds(){CloseMyFeeds();ShowReferral();$get("checkCloneOption").checked=true;$("#refer-by-email").effect("highlight",{},3000)}function NewRssFeedKeyed(b){var a=b.keyCode;if(a==13){$("#btnNewRssFeed").click();return false}return true}function NewRequestFeedKeyed(b){var a=b.keyCode;if(a==13){$("#btnNewSite").click();return false}return true}var checkStatusCount=0;var importedCount=0;function ShowImportFeeds(){window.scroll(0,0);$("body").css("overflow","hidden");$get("importFeedsOverlay").style.display="block";$get("fade").style.display="block"}function CloseImportFeeds(){if($get("importFeedsOverlay").style.display=="block"){$("body").css("overflow","auto");$get("importFeedsOverlay").style.display="none";$get("fade").style.display="none";if(importedCount>0){window.location.reload()}}}function ajaxFileUpload(a,b){ShowImportLoader();$("#importStatus").html("Uploading File");$.ajaxFileUpload({url:"FileUploader.ashx",secureuri:false,fileElementId:b,dataType:"json",data:{fileType:a},success:function(d,c){if(typeof(d.error)!="undefined"){if(d.error!=""){$("#importStatus").html(d.error);HideImportLoader()}else{var e=d.msg;$("#importStatus").html("Processing file, this could take a few minutes...");window.setTimeout(function(){CheckImportStatus(e)},5000)}}},error:function(d,c,f){$("#importStatus").html("Sorry, there was an error uploading your file.");HideImportLoader()}});return false}function CheckImportStatus(a){checkStatusCount++;$.ajax({type:"POST",url:"FeedSearchServiceExporter.asmx/CheckImportStatus",data:{requestId:a},success:OnCheckImportSuccess(a),error:function(d,b,c){window.setTimeout(function(){CheckImportStatus(a)},5000)}})}var OnCheckImportSuccess=function(a){return function(c,d){var b=parseInt(c.documentElement.childNodes[0].wholeText?c.documentElement.childNodes[0].wholeText:c.documentElement.childNodes[0].data);if(b==-1){if(checkStatusCount<36){window.setTimeout(function(){CheckImportStatus(a)},5000)}else{}}else{if(b==200){$("#importStatus").html("Processing complete - 200 (MAX limit) RSS feeds imported.")}else{$("#importStatus").html("Processing complete - "+b+" RSS feeds imported.")}HideImportLoader();if(b>0){StreamOnLoad();importedCount=b}}}};function ShowImportLoader(){$("#importLoader").css("display","block")}function HideImportLoader(){$("#importLoader").css("display","none")};